{
    "mentioned_cpes": ["CVE-2022-31199"],
    "issue_name": "Increased Truebot Activity Infects U.S. and Canada Based Networks",
    "steps_to_fix": {
        "1": {
            "command": "Update Netwrix Auditor",
            "description": "Update Netwrix Auditor to version 10.5 to apply patches to CVE-2022-31199."
        },
        "2": {
            "command": "Implement application controls",
            "description": "Implement application controls to manage and control execution of software, including allowlisting remote access programs."
        },
        "3": {
            "command": "Limit RDP usage",
            "description": "Strictly limit the use of RDP and other remote desktop services. If RDP is necessary, rigorously apply best practices such as auditing the network for systems using RDP, closing unused RDP ports, enforcing account lockouts after a specified number of attempts, applying phishing-resistant multifactor authentication (MFA), and logging RDP login attempts."
        },
        "4": {
            "command": "Disable command-line and scripting activities",
            "description": "Disable command-line and scripting activities and permissions."
        },
        "5": {
            "command": "Restrict PowerShell usage",
            "description": "Restrict the use of PowerShell by using Group Policy, and only grant to specific users on a case-by-case basis."
        },
        "6": {
            "command": "Update PowerShell",
            "description": "Update Windows PowerShell or PowerShell Core to the latest version and uninstall all earlier PowerShell versions."
        },
        "7": {
            "command": "Enable enhanced PowerShell logging",
            "description": "Ensure PowerShell instances, using the latest version, have module, script block, and transcription logging enabled (enhanced logging)."
        },
        "8": {
            "command": "Configure Windows Registry for UAC",
            "description": "Configure the Windows Registry to require User Account Control (UAC) approval for any PsExec operations requiring administrator privileges."
        },
        "9": {
            "command": "Review accounts",
            "description": "Review domain controllers, servers, workstations, and active directories for new and/or unrecognized accounts."
        },
        "10": {
            "command": "Audit user accounts",
            "description": "Audit user accounts with administrative privileges and configure access controls according to the principle of least privilege (PoLP)."
        },
        "11": {
            "command": "Implement Credential Guard",
            "description": "Implement Credential Guard for Windows 10 and Server 2016. For Windows Server 2012R2, enable Protected Process Light for Local Security Authority (LSA)."
        },
        "12": {
            "command": "Implement time-based access",
            "description": "Implement time-based access for accounts set at the admin level and higher."
        },
        "13": {
            "command": "Disable File and Printer sharing",
            "description": "Disable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication."
        },
        "14": {
            "command": "Implement a recovery plan",
            "description": "Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location."
        },
        "15": {
            "command": "Maintain offline backups",
            "description": "Maintain offline backups of data and regularly maintain backup and restoration (daily or weekly at minimum)."
        },
        "16": {
            "command": "Require password compliance",
            "description": "Require all accounts with password logins to comply with National Institute for Standards and Technology (NIST) standards for developing and managing password policies."
        },
        "17": {
            "command": "Require phishing-resistant MFA",
            "description": "Require phishing-resistant multifactor authentication for all services to the extent possible."
        },
        "18": {
            "command": "Keep systems up to date",
            "description": "Keep all operating systems, software, and firmware up to date. Patch vulnerable software and hardware systems within 24 to 48 hours of vulnerability disclosure."
        },
        "19": {
            "command": "Segment networks",
            "description": "Segment networks to prevent the spread of ransomware."
        },
        "20": {
            "command": "Implement network monitoring",
            "description": "Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool."
        },
        "21": {
            "command": "Install antivirus software",
            "description": "Install, regularly update, and enable real-time detection for antivirus software on all hosts."
        },
        "22": {
            "command": "Disable unused ports",
            "description": "Disable unused ports."
        },
        "23": {
            "command": "Add email banner",
            "description": "Consider adding an email banner to emails received from outside your organization."
        },
        "24": {
            "command": "Encrypt backup data",
            "description": "Ensure all backup data is encrypted, immutable, and covers the entire organizationâ€™s data infrastructure."
        }
    },
    "paths": {
        "1": [1],
        "2": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
    }
}