{
    "mentioned_cpes": [
        "CVE-2021-44228",
        "CVE-2021-20038",
        "CVE-2022-24990"
    ],
    "issue_name": "Ransomware Attacks on Critical Infrastructure Fund DPRK Malicious Cyber Activities",
    "steps_to_fix": {
        "1": {
            "command": "Stop Apache Server",
            "description": "The apache server has to be stopped in order to patch the system. This is done via: service apache2 stop"
        },
        "2": {
            "command": "Update system",
            "description": "Update the whole linux server using the command: sudo apt-get update && apt-get upgrade -y"
        },
        "3": {
            "command": "Apply patches for CVE-2021-44228",
            "description": "Apply patches provided by vendor and perform required system updates."
        },
        "4": {
            "command": "Upgrade SonicWall SMA100",
            "description": "Upgrade to SonicWall SMA100 build versions 10.2.0.9-41sv or later, or 10.2.1.3-27sv or later."
        },
        "5": {
            "command": "Install TOS version 4.2.30",
            "description": "Install relevant vendor patches. This vulnerability was patched in TOS version 4.2.30."
        },
        "6": {
            "command": "Limit access to data",
            "description": "Authenticate and encrypt connections using public key infrastructure certificates in VPN and TLS connections."
        },
        "7": {
            "command": "Implement least privilege",
            "description": "Use standard user accounts on internal systems instead of administrative accounts."
        },
        "8": {
            "command": "Turn off weak network interfaces",
            "description": "Turn off weak or unnecessary network device management interfaces, such as Telnet, SSH, Winbox, and HTTP for WANs."
        },
        "9": {
            "command": "Protect stored data",
            "description": "Mask the permanent account number (PAN) when displayed and render it unreadable when stored through cryptography."
        },
        "10": {
            "command": "Secure PII/PHI",
            "description": "Secure the collection, storage, and processing practices for PII/PHI per regulations such as HIPAA."
        },
        "11": {
            "command": "Implement network segmentation",
            "description": "Implement and enforce multi-layer network segmentation with the most critical communications and data resting on the most secure and reliable layer."
        },
        "12": {
            "command": "Use monitoring tools",
            "description": "Use monitoring tools to observe whether IoT devices are behaving erratically due to a compromise."
        },
        "13": {
            "command": "Maintain isolated backups",
            "description": "Maintain isolated backups of data, and regularly test backup and restoration."
        },
        "14": {
            "command": "Create incident response plan",
            "description": "Create, maintain, and exercise a basic cyber incident response plan and associated communications plan that includes response procedures for a ransomware incident."
        },
        "15": {
            "command": "Install updates",
            "description": "Install updates for operating systems, software, and firmware as soon as they are released."
        },
        "16": {
            "command": "Secure RDP",
            "description": "If you use RDP, secure and monitor it closely. Limit access to resources over internal networks, especially by restricting RDP and using virtual desktop infrastructure."
        },
        "17": {
            "command": "Ensure proper device configuration",
            "description": "Ensure devices are properly configured and that security features are enabled. Disable ports and protocols not in use for a business purpose."
        },
        "18": {
            "command": "Restrict SMB protocol",
            "description": "Restrict the SMB protocol within the network to only access necessary servers and remove or disable outdated versions of SMB."
        },
        "19": {
            "command": "Review third-party security",
            "description": "Review the security posture of third-party vendors and those interconnected with your organization."
        },
        "20": {
            "command": "Implement application control policies",
            "description": "Implement application control policies that only allow systems to execute known and permitted programs."
        },
        "21": {
            "command": "Open document readers in protected mode",
            "description": "Open document readers in protected viewing modes to help prevent active content from running."
        },
        "22": {
            "command": "Implement user training program",
            "description": "Implement a user training program and phishing exercises to raise awareness among users about the risks of visiting websites, clicking on links, and opening attachments."
        },
        "23": {
            "command": "Require phishing-resistant MFA",
            "description": "Require phishing-resistant MFA for as many services as possible, particularly for webmail, VPNs, accounts that access critical systems, and privileged accounts that manage backups."
        },
        "24": {
            "command": "Use strong passwords",
            "description": "Use strong passwords and avoid reusing passwords for multiple accounts."
        },
        "25": {
            "command": "Require admin credentials for software installation",
            "description": "Require administrator credentials to install software."
        },
        "26": {
            "command": "Audit user accounts",
            "description": "Audit user accounts with administrative or elevated privileges and configure access controls with least privilege in mind."
        },
        "27": {
            "command": "Install antivirus software",
            "description": "Install and regularly update antivirus and antimalware software on all hosts."
        },
        "28": {
            "command": "Use secure networks",
            "description": "Only use secure networks. Consider installing and using a VPN."
        },
        "29": {
            "command": "Add email banner",
            "description": "Consider adding an email banner to messages coming from outside your organizations indicating that they are higher risk messages."
        },
        "30": {
            "command": "Participate in AIS program",
            "description": "Consider participating in CISA’s no-cost Automated Indicator Sharing (AIS) program to receive real-time exchange of machine-readable cyber threat indicators and defensive measures."
        },
        "31": {
            "command": "Follow ransomware response checklist",
            "description": "Follow your organization’s ransomware response checklist."
        },
        "32": {
            "command": "Scan backups",
            "description": "If possible, scan backup data with an antivirus program to check that it is free of malware."
        },
        "33": {
            "command": "Report incidents",
            "description": "Report incidents to appropriate authorities; in the U.S., this would include the FBI at a local FBI Field Office, CISA at cisa.gov/report, or the U.S. Secret Service (USSS) at a USSS Field Office."
        }
    },
    "paths": {
        "1": [1, 2, 3, 4, 5],
        "2": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33]
    }
}